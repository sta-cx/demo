<view class="container">
  <!-- å¤´éƒ¨ä¿¡æ¯ -->
  <view class="header">
    <text class="title">ğŸ’• å†å²è®°å½•</text>
    <view class="stats" wx:if="{{stats}}">
      <view class="stat-item">
        <text>ğŸ’¬ {{stats.total_answers}} æ¡å›ç­”</text>
      </view>
      <view class="stat-item">
        <text>ğŸ˜Š {{stats.positive_answers}} æ¡ç§¯æ</text>
      </view>
      <view class="stat-item" wx:if="{{stats.completion_rate}}">
        <text>ğŸ“ˆ {{stats.completion_rate}}% å®Œæˆç‡</text>
      </view>
    </view>
  </view>

  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <picker 
      mode="date" 
      value="{{filterDate}}" 
      bindchange="onDateChange"
      start="{{minDate}}"
      end="{{maxDate}}"
    >
      <view class="filter-item">
        <text>ğŸ“… {{filterDate || 'é€‰æ‹©æ—¥æœŸ'}}</text>
      </view>
    </picker>
    
    <picker 
      bindchange="onCategoryChange" 
      value="{{categoryIndex}}" 
      range="{{categories}}"
      range-key="label"
    >
      <view class="filter-item">
        <text>ğŸ·ï¸ {{categories[categoryIndex].label}}</text>
      </view>
    </picker>
  </view>

  <!-- å†å²è®°å½•åˆ—è¡¨ -->
  <view class="history-list" wx:if="{{answers.length > 0}}">
    <view 
      class="history-item" 
      wx:for="{{answers}}" 
      wx:key="id"
      bindtap="viewDetail"
      data-id="{{item.id}}"
      hover-class="item-hover"
    >
      <!-- é—®é¢˜éƒ¨åˆ† -->
      <view class="question-section">
        <text class="question-text">{{item.question_text}}</text>
        <view class="question-meta">
          <view class="category-tag tag tag-primary">
            <text>{{item.category}}</text>
          </view>
          <view class="date">
            <text>ğŸ• {{item.answer_date}}</text>
          </view>
        </view>
      </view>
      
      <!-- å›ç­”éƒ¨åˆ† -->
      <view class="answer-section">
        <!-- æˆ‘çš„å›ç­” -->
        <view class="user-answer">
          <text class="answer-label">ğŸ’­ æˆ‘çš„å›ç­”</text>
          <view class="answer-content">
            <text>{{item.answer_text}}</text>
          </view>
          <image 
            wx:if="{{item.media_url}}" 
            class="answer-media" 
            src="{{item.media_url}}" 
            mode="aspectFill"
            bindtap="previewPhoto"
            data-url="{{item.media_url}}"
            catchtap="stopPropagation"
          />
          <view class="answer-sentiment" wx:if="{{item.sentiment}}">
            <text class="sentiment-icon">
              {{item.sentiment === 'positive' ? 'ğŸ˜Š' : item.sentiment === 'negative' ? 'ğŸ˜”' : 'ğŸ˜'}}
            </text>
            <text class="sentiment-text">{{item.sentiment}}</text>
          </view>
        </view>
        
        <!-- ä¼´ä¾£çš„å›ç­” -->
        <view class="partner-answer" wx:if="{{item.partner_answer}}">
          <text class="answer-label">ğŸ’ TAçš„å›ç­”</text>
          <view class="answer-content">
            <text>{{item.partner_answer.answer_text}}</text>
          </view>
          <image 
            wx:if="{{item.partner_answer.media_url}}" 
            class="answer-media" 
            src="{{item.partner_answer.media_url}}" 
            mode="aspectFill"
            bindtap="previewPhoto"
            data-url="{{item.partner_answer.media_url}}"
            catchtap="stopPropagation"
          />
          <view class="answer-sentiment" wx:if="{{item.partner_answer.sentiment}}">
            <text class="sentiment-icon">
              {{item.partner_answer.sentiment === 'positive' ? 'ğŸ˜Š' : item.partner_answer.sentiment === 'negative' ? 'ğŸ˜”' : 'ğŸ˜'}}
            </text>
            <text class="sentiment-text">{{item.partner_answer.sentiment}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-title">æš‚æ— è®°å½•</text>
    <text class="empty-desc">å¼€å§‹å›ç­”é—®é¢˜ï¼Œè®°å½•ä½ ä»¬çš„ç‚¹ç‚¹æ»´æ»´</text>
    <button class="btn btn-primary" bindtap="goToAnswer" style="margin-top: 40rpx;">
      <text>ğŸ’ å¼€å§‹å›ç­”</text>
    </button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>